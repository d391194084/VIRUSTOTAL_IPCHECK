name: ğŸ¤– å…¨è‡ªå‹•è³‡å®‰åˆ†æèˆ‡ Drive æ­¸æª”

on:
  workflow_dispatch:
    inputs:
      target_ip:
        description: 'ğŸ‘‰ è«‹è¼¸å…¥è¦æƒæçš„ IP åœ°å€'
        required: true
        type: string

jobs:
  analyze_and_upload:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ å–å¾—ç¨‹å¼ç¢¼
        uses: actions/checkout@v4

      - name: ğŸ è¨­å®š Python ç’°å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: ğŸ“¦ å®‰è£æ‰€éœ€å¥—ä»¶
        run: |
          pip install google-genai python-docx google-api-python-client google-auth-httplib2 google-auth-oauthlib

      - name: ğŸš€ åŸ·è¡Œå…¨è‡ªå‹•åˆ†æèˆ‡ä¸Šå‚³
        env:
          VT_API_KEY: ${{ secrets.VT_API_KEY }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          GDRIVE_FOLDER_ID: ${{ secrets.GDRIVE_FOLDER_ID }}
          # ä»¥ä¸‹ä¸‰å€‹æ˜¯å…¨æ–°çš„ OAuth æˆæ¬Šè®Šæ•¸
          GDRIVE_CLIENT_ID: ${{ secrets.GDRIVE_CLIENT_ID }}
          GDRIVE_CLIENT_SECRET: ${{ secrets.GDRIVE_CLIENT_SECRET }}
          GDRIVE_REFRESH_TOKEN: ${{ secrets.GDRIVE_REFRESH_TOKEN }}
          
        run: |
          python auto_analyst.py ${{ github.event.inputs.target_ip }}
